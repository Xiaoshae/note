# python pwntools procæ¨¡å—



# binary

æŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸å¯¹å…¶è¿›è¡Œæ£€æŸ¥

context.binary = binary = ELF("./pwn109",checksec=False)



# level_log

æŒ‡å®šæ—¥å¿—ç­‰çº§ï¼Œè®¾ç½®ä¸ºdebugä»¥æ–¹ä¾¿å¯»æ‰¾é”™è¯¯

context.log_level = "debug"



# process

process()å‡½æ•°æ˜¯Pythonçš„pwntoolsåº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œå¹¶ä½¿ç”¨ç®¡é“è¿›è¡Œé€šä¿¡



# pidof

pidof()å‡½æ•°æ˜¯Pythonçš„pwntoolsåº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºè·å–ç›®æ ‡çš„è¿›ç¨‹IDã€‚è¿”å›çš„PIDå–å†³äºç›®æ ‡çš„ç±»å‹1ï¼š

- å¦‚æœç›®æ ‡æ˜¯å­—ç¬¦ä¸²ï¼šè¿”å›æ‰€æœ‰è¿›ç¨‹åç§°ä¸ç›®æ ‡åŒ¹é…çš„è¿›ç¨‹çš„PIDã€‚
- å¦‚æœç›®æ ‡æ˜¯pwnlib.tubes.process.processï¼šè¿”å›ç›®æ ‡çš„PIDçš„å•ä¾‹åˆ—è¡¨ã€‚



# wait_for_debugger

wait_for_debugger()å‡½æ•°æ˜¯Pythonçš„pwntoolsåº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºç­‰å¾…è¿›ç¨‹è¢«è·Ÿè¸ª1ã€‚å¦‚æœè®¾ç½®äº†debugger_pidå¹¶ä¸”è°ƒè¯•å™¨é€€å‡ºï¼Œå®ƒå°†å¼•å‘é”™è¯¯1ã€‚ä»¥ä¸‹æ˜¯è¯¥å‡½æ•°çš„å‚æ•°çš„è¯¦ç»†è¯´æ˜ï¼š

- pidï¼ˆæ•´æ•°ï¼‰ï¼šè¿›ç¨‹çš„PIDã€‚
- debugger_pidï¼ˆæ•´æ•°ï¼‰ï¼šè°ƒè¯•å™¨çš„PIDã€‚å¦‚æœè®¾ç½®äº†æ­¤å‚æ•°å¹¶ä¸”è°ƒè¯•å™¨é€€å‡ºï¼Œå°†å¼•å‘é”™è¯¯ã€‚



# recvuntil

recvuntil()å‡½æ•°æ˜¯Pythonçš„pwntoolsåº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºä»è¿›ç¨‹ä¸­è¯»å–æ•°æ®ï¼Œç›´åˆ°é‡åˆ°æŒ‡å®šçš„åˆ†éš”ç¬¦1ã€‚ä»¥ä¸‹æ˜¯è¯¥å‡½æ•°çš„å‚æ•°çš„è¯¦ç»†è¯´æ˜ï¼š

delimsï¼ˆå­—ç¬¦ä¸²æˆ–å­—èŠ‚ï¼‰ï¼šåˆ†éš”ç¬¦ã€‚å‡½æ•°å°†ä¸€ç›´è¯»å–æ•°æ®ï¼Œç›´åˆ°é‡åˆ°è¿™ä¸ªåˆ†éš”ç¬¦1ã€‚
dropï¼ˆå¸ƒå°”å€¼ï¼‰ï¼šå¦‚æœè®¾ç½®ä¸ºTrueï¼Œåˆ™è¿”å›çš„æ•°æ®å°†ä¸åŒ…å«åˆ†éš”ç¬¦1ã€‚



# pause

pwntoolsåº“ä¸­æœ‰ä¸€ä¸ªåä¸ºpause()çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥æš‚åœç¨‹åºçš„è¿è¡Œï¼Œç›´åˆ°ç”¨æˆ·è¾“å…¥ä»»ä½•å†…å®¹åï¼Œç¨‹åºæ‰ä¼šç»§ç»­è¿è¡Œã€‚è¿™ä¸ªå‡½æ•°æ²¡æœ‰å‚æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨pause()å‡½æ•°çš„ä¾‹å­ï¼š

```python
from pwn import *
print("ç¨‹åºå³å°†æš‚åœ...")
pause()
print("ç¨‹åºç»§ç»­è¿è¡Œï¼")
```



# å‘é€å‡½æ•°

## send

`send()`å‡½æ•°å¯ä»¥å‘è¿›ç¨‹çš„stdinå†™å…¥æ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.send(b'aaaa')
```



## sendline

`sendline()`å‡½æ•°å¯ä»¥å‘è¿›ç¨‹çš„stdinå†™å…¥æ•°æ®ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ä¾‹å¦‚ï¼š

```python
p.sendline(b'aaaa')
```

è¿™ç­‰åŒäº`p.send(b'aaaa' + b'\\n')`ã€‚



## sendafter

`sendafter()`å‡½æ•°å¯ä»¥åœ¨è¯»å–åˆ°æŒ‡å®šå­—ç¬¦ä¸²åå‘è¿›ç¨‹å†™å…¥æ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.sendafter('some string', b'aaaa')
```



## sendlineafter

`sendlineafter()`å‡½æ•°å¯ä»¥åœ¨è¯»å–åˆ°æŒ‡å®šå­—ç¬¦ä¸²åå‘è¿›ç¨‹å†™å…¥æ•°æ®ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ä¾‹å¦‚ï¼š

```python
p.sendlineafter('some string', b'aaaa')
```



## write

`write()`å‡½æ•°å¯ä»¥å‘è¿›ç¨‹çš„stdinå†™å…¥æ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.write(b'aaaa')
```



## writeline

`writeline()`å‡½æ•°å¯ä»¥å‘è¿›ç¨‹çš„stdinå†™å…¥æ•°æ®ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ä¾‹å¦‚ï¼š

```python
p.writeline(b'aaaa')
```

è¿™ç­‰åŒäº`p.write(b'aaaa' + b'\\n')`ã€‚



## writeafter

`writeafter()`å‡½æ•°å¯ä»¥åœ¨è¯»å–åˆ°æŒ‡å®šå­—ç¬¦ä¸²åå‘è¿›ç¨‹å†™å…¥æ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.writeafter('some string', b'aaaa')
```



## writelineafter

`writelineafter()`å‡½æ•°å¯ä»¥åœ¨è¯»å–åˆ°æŒ‡å®šå­—ç¬¦ä¸²åå‘è¿›ç¨‹å†™å…¥æ•°æ®ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ä¾‹å¦‚ï¼š

```python
p.writelineafter('some string', b'aaaa')
```



# æ¥æ”¶å‡½æ•°

## recv

`recv()`å‡½æ•°å¯ä»¥ä»è¿›ç¨‹çš„stdoutè¯»å–æŒ‡å®šæ•°é‡çš„å­—èŠ‚ã€‚ä¾‹å¦‚ï¼š

```python
p.recv(123)
```



## recvline

`recvline()`å‡½æ•°å¯ä»¥ä»è¿›ç¨‹çš„stdoutè¯»å–ä¸€è¡Œæ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.recvline()
```

è¿™ç­‰åŒäº`p.recvuntil('\\n')`ã€‚



## recvuntil

`recvuntil()`å‡½æ•°å¯ä»¥ä»è¿›ç¨‹çš„stdoutè¯»å–æ•°æ®ï¼Œç›´åˆ°é‡åˆ°æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼š

```python
p.recvuntil('some string')
```



## recvall

`recvall()`å‡½æ•°å¯ä»¥è¯»å–è¿›ç¨‹çš„stdoutä¸­çš„æ‰€æœ‰æ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.recvall()
```



## clean

`clean()`å‡½æ•°å¯ä»¥è¯»å–è¿›ç¨‹çš„stdoutä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚ä¾‹å¦‚ï¼š

```python
p.clean(1)
```



## read

`read()`å‡½æ•°å¯ä»¥ä»è¿›ç¨‹çš„stdoutè¯»å–æŒ‡å®šæ•°é‡çš„å­—èŠ‚ã€‚ä¾‹å¦‚ï¼š

```python
p.read(123)
```



## readline

`readline()`å‡½æ•°å¯ä»¥ä»è¿›ç¨‹çš„stdoutè¯»å–ä¸€è¡Œæ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.readline()
```

è¿™ç­‰åŒäº`p.readuntil('\\n')`ã€‚



## readuntil

`readuntil()`å‡½æ•°å¯ä»¥ä»è¿›ç¨‹çš„stdoutè¯»å–æ•°æ®ï¼Œç›´åˆ°é‡åˆ°æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼š

```python
p.readuntil('some string')
```



## readall

`readall()`å‡½æ•°å¯ä»¥è¯»å–è¿›ç¨‹çš„stdoutä¸­çš„æ‰€æœ‰æ•°æ®ã€‚ä¾‹å¦‚ï¼š

```python
p.readall()
```



# ç¤ºä¾‹

```python
#!/usr/bin/env python
from pwn import *


context.binary = binary = ELF("./pwn109",checksec=False)
context.log_level = "debug"

#å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹
p = process()

#è·å–è¿›ç¨‹çš„pid
pid = util.proc.pidof(p)
pid = pid[0]

#ç­‰å¾…è¿›ç¨‹è¢«è·Ÿè¸ª
util.proc.wait_for_debugger(pid)

#ä»ç¨‹åºä¸­æŒç»­è¯»å–å†…å®¹ï¼Œç›´åˆ°é‡åˆ°"ahead ğŸ˜\n"
p.recvuntil("ahead ğŸ˜\n")

#å‘é€yes  æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰å‘é€æ¢è¡Œç¬¦ï¼Œä¹Ÿå°±æ˜¯æˆ–ç¨‹åºä¼šç»§ç»­ç›‘å¬é”®ç›˜ï¼Œç›´åˆ°ç”¨æˆ·è¾“å…¥å›è½¦
p.send(b"yes")

#"å°† a1b2c3 è½¬ä¸º c3b2a1"
def reverse_pairs(s):
    # å°†å­—ç¬¦ä¸²åˆ†å‰²æˆæ¯ä¸¤ä¸ªå­—ç¬¦ä¸€ç»„
    pairs = [s[i:i+2] for i in range(0, len(s), 2)]
    # åè½¬æ•´ä¸ªåˆ—è¡¨å¹¶è¿æ¥æˆå­—ç¬¦ä¸²
    return ''.join(pairs[::-1])


```



å¯åŠ¨è¿›ç¨‹ï¼Œç­‰å¾…è¢«è·Ÿè¸ª

![image-20231122221806067](images/pwntools.assets/image-20231122221806067.png)



gdb è·Ÿè¸ªè¿›ç¨‹

![image-20231122221855626](images/pwntools.assets/image-20231122221855626.png)



è¢«è·Ÿè¸ªåç¨‹åºç»§ç»­è¿è¡Œ

![image-20231122221939265](images/pwntools.assets/image-20231122221939265.png)



æ­¤æ—¶è¿˜å¯ä»¥é€šè¿‡gdbæ¥è°ƒè¯•ç¨‹åº

æŸ¥çœ‹å½“å‰è¿è¡Œçš„ç¨‹åºï¼Œåˆ°äº†ä»€ä¹ˆä½ç½®

![image-20231122222131752](images/pwntools.assets/image-20231122222131752.png)



æŸ¥çœ‹å¯„å­˜å™¨å†…å®¹ï¼Œè·å–æ ˆä½ç½®

![image-20231122222212972](images/pwntools.assets/image-20231122222212972.png)



ç„¶åæŸ¥çœ‹æ ˆä¸Šçš„å†…å®¹ï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼çœ‹çœ‹ï¼Œexpæ˜¯å¦æŒ‰ç…§æƒ³è¦çš„æ–¹å¼æ­£ç¡®çš„è¦†ç›–äº†æ ˆä¸Šçš„å†…å®¹

![image-20231122222443222](images/pwntools.assets/image-20231122222443222.png)

